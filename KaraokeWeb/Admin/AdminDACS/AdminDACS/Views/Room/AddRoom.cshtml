@model AdminDACS.Models.Room

@{
    ViewData["Title"] = "Thêm phòng";
}

<h2 class="mb-4 animated-title">Thêm phòng</h2>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert" id="successAlert">
        <strong>Thành công!</strong> @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}
else
{
    <form asp-action="AddRoom" enctype="multipart/form-data" method="post" id="roomForm">
        <input asp-for="MaPhong" type="hidden" />

        <div class="form-group mb-3">
            <label asp-for="TenPhong" class="form-label">Tên phòng</label>
            <input asp-for="TenPhong" class="form-control input-focus" />
            <span asp-validation-for="TenPhong" class="text-danger"></span>
        </div>

        <div class="form-group mb-3">
            <label asp-for="Gia" class="form-label">Giá</label>
            <input asp-for="Gia" type="number" class="form-control input-focus" />
            <span asp-validation-for="Gia" class="text-danger"></span>
        </div>

        <div class="form-group mb-3">
            <label asp-for="SucChua" class="form-label">Sức chứa</label>
            <input asp-for="SucChua" type="number" class="form-control input-focus" />
            <span asp-validation-for="SucChua" class="text-danger"></span>
        </div>

        <div class="form-group mb-3">
            <label class="form-label">Ảnh đại diện</label>
            <input asp-for="ImageFile" type="file" class="form-control" accept="image/*" onchange="previewImage(event)" />
            <span asp-validation-for="ImageFile" class="text-danger"></span>
            <div class="mt-2">
                <img id="imagePreview" src="#" alt="Xem trước ảnh" style="display:none; max-height:200px;" class="rounded shadow transition" />
            </div>
        </div>

        <div class="form-group mb-3">
            <label asp-for="MaLoaiPhong" class="form-label">Loại phòng</label>
            <select asp-for="MaLoaiPhong" asp-items="ViewBag.LoaiPhongList" class="form-select input-focus">
                <option value="">-- Chọn loại phòng --</option>
            </select>
            <span asp-validation-for="MaLoaiPhong" class="text-danger"></span>
        </div>

        <button type="submit" id="submitBtn" class="btn btn-primary mt-2">
            <span id="btnText">Thêm phòng</span>
            <span id="btnSpinner" class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true"></span>
        </button>
    </form>
}
@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        function previewImage(event) {
            const input = event.target;
            const preview = document.getElementById("imagePreview");
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    preview.src = e.target.result;
                    preview.style.display = "block";
                    preview.style.opacity = 0;
                    setTimeout(() => {
                        preview.style.opacity = 1;
                    }, 100);
                };
                reader.readAsDataURL(input.files[0]);
            } else {
                preview.src = "#";
                preview.style.display = "none";
            }
        }

        document.getElementById("roomForm").addEventListener("submit", function () {
            const btn = document.getElementById("submitBtn");
            const spinner = document.getElementById("btnSpinner");
            const btnText = document.getElementById("btnText");

            btn.disabled = true;
            btnText.textContent = "Đang xử lý...";
            spinner.classList.remove("d-none");
        });
    </script>
    <script>
        setTimeout(() => {
            const alert = document.getElementById("successAlert");
            if (alert) {
                const bsAlert = new bootstrap.Alert(alert);
                bsAlert.close();
            }
        }, 4000);
    </script>

    <style>
        .input-focus:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 5px rgba(13, 110, 253, 0.5);
            transition: 0.3s ease;
        }

        .transition {
            transition: opacity 0.5s ease-in-out;
        }

        .animated-title {
            font-weight: 700;
            font-size: 2.5rem;
            background: linear-gradient(270deg, #0d6efd, #6610f2, #0d6efd);
            background-size: 600% 600%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientMove 8s ease infinite;
            text-shadow: 1px 1px 4px rgba(13, 110, 253, 0.7);
            user-select: none;
        }

        keyframes gradientMove {
            0%

        {
            background-position: 0% 50%;
        }

        50% {
            background-position: 100% 50%;
        }

        100% {
            background-position: 0% 50%;
        }

        }
    </style>
}
